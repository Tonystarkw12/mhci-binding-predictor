# MHC-I å¤šè‚½ç»“åˆäº²å’ŒåŠ›é¢„æµ‹æ¨¡å‹

åŸºäºæ·±åº¦å­¦ä¹ çš„ HLA-A\*02:01 åˆ†å­å¤šè‚½ç»“åˆäº²å’ŒåŠ›é¢„æµ‹ç³»ç»Ÿ

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

### ç ”ç©¶èƒŒæ™¯

è‚¿ç˜¤å…ç–«é€ƒé€¸æ˜¯è‚¿ç˜¤å‘å±•å’Œè½¬ç§»çš„å…³é”®æœºåˆ¶ä¹‹ä¸€ã€‚æ–°æŠ—åŸï¼ˆNeoantigenï¼‰çš„è¯†åˆ«å’Œå‘ˆé€’æ˜¯å…ç–«ç³»ç»Ÿæ¸…é™¤è‚¿ç˜¤ç»†èƒçš„é‡è¦é€”å¾„ï¼Œè€Œè¿™ä¸€è¿‡ç¨‹ä¾èµ–äºä¸»è¦ç»„ç»‡ç›¸å®¹æ€§å¤åˆä½“ I ç±»ï¼ˆMHC-Iï¼‰åˆ†å­å°†è‚¿ç˜¤ç»†èƒå†…äº§ç”Ÿçš„çªå˜è‚½æ®µå‘ˆé€’åˆ°ç»†èƒè¡¨é¢ä¾› T ç»†èƒè¯†åˆ«ã€‚

**HLA-A\*02:01** æ˜¯äººç¾¤ä¸­é¢‘ç‡æœ€é«˜çš„ HLA-I ç±»ç­‰ä½åŸºå› ä¹‹ä¸€ï¼ˆçº¦ 40-50% çš„æ¬§æ´²äººç¾¤å’Œçº¦ 20-30% çš„ä¸œäºšäººç¾¤è¡¨è¾¾ï¼‰ã€‚é¢„æµ‹çªå˜è‚½æ®µä¸ HLA-A\*02:01 çš„ç»“åˆäº²å’ŒåŠ›ï¼Œå¯¹äºï¼š

- **è‚¿ç˜¤æ–°æŠ—åŸé¢„æµ‹**ï¼šè¯†åˆ«è‚¿ç˜¤ç‰¹å¼‚æ€§çªå˜è‚½æ®µï¼Œä¸ºä¸ªæ€§åŒ–è‚¿ç˜¤ç–«è‹—è®¾è®¡æä¾›é¶ç‚¹
- **å…ç–«é€ƒé€¸æœºåˆ¶ç ”ç©¶**ï¼šç†è§£è‚¿ç˜¤å¦‚ä½•é€šè¿‡ä¸‹è°ƒ MHC è¡¨è¾¾æˆ–æ”¹å˜æŠ—åŸå‘ˆé€’é€”å¾„é€ƒé¿å…ç–«ç›‘è§†
- **ç²¾å‡†å…ç–«æ²»ç–—**ï¼šç­›é€‰é«˜å…ç–«åŸæ€§çš„æ–°æŠ—åŸï¼Œä¼˜åŒ–è¿‡ç»§æ€§ T ç»†èƒæ²»ç–—å’Œç™Œç—‡ç–«è‹—ç–—æ•ˆ

### é¡¹ç›®æ„ä¹‰

æœ¬é¡¹ç›®é‡‡ç”¨æ·±åº¦å­¦ä¹ æ–¹æ³•æ„å»º MHC-I ç»“åˆäº²å’ŒåŠ›é¢„æµ‹æ¨¡å‹ï¼Œå±•ç¤ºäº†ä»¥ä¸‹æ ¸å¿ƒèƒ½åŠ›ï¼š

1. **ç”Ÿç‰©ä¿¡æ¯å­¦æ•°æ®å¤„ç†**ï¼šä» IEDB å…¬å…±æ•°æ®åº“è·å–å’Œå¤„ç†å¤šè‚½æ•°æ®
2. **æ·±åº¦å­¦ä¹ æ¨¡å‹è®¾è®¡**ï¼šè®¾è®¡åŸºäº Conv1d çš„ç¥ç»ç½‘ç»œæ•æ‰å¤šè‚½åºåˆ—çš„ Motif ç‰¹å¾
3. **é«˜æ€§èƒ½è®¡ç®—**ï¼šåˆ©ç”¨ GPU åŠ é€Ÿè®­ç»ƒï¼Œå±•ç¤ºè®¡ç®—ç”Ÿç‰©å­¦ç ”ç©¶çš„æŠ€æœ¯èƒ½åŠ›
4. **æ¨¡å‹è¯„ä¼°ä¸å¯è§†åŒ–**ï¼šå…¨é¢çš„æ€§èƒ½åˆ†æå’Œä¸“ä¸šçš„ç»“æœå±•ç¤º

---

## ğŸ¯ ç ”ç©¶ç›®æ ‡

- [x] æ„å»º HLA-A\*02:01 å¤šè‚½ç»“åˆäº²å’ŒåŠ›é¢„æµ‹æ¨¡å‹
- [x] å®ç°ç«¯åˆ°ç«¯çš„æ•°æ®å¤„ç†æµç¨‹
- [x] ç”Ÿæˆ ROC æ›²çº¿ã€æ··æ·†çŸ©é˜µç­‰è¯„ä¼°æŒ‡æ ‡
- [x] æ¢ç´¢å¤šè‚½åºåˆ—ç‰¹å¾ä¸ MHC-I ç»“åˆçš„å…³è”

---

## ğŸ“Š æ•°æ®æ¥æº

**IEDB (Immune Epitope Database)**

- æ•°æ®åº“ URLï¼šhttps://www.iedb.org/
- åŒ…å«è¶…è¿‡ 100 ä¸‡æ¡ MHC-I ç»“åˆå®éªŒæ•°æ®
- ç­›é€‰æ¡ä»¶ï¼šAllele = "HLA-A\*02:01"ï¼Œå¤šè‚½é•¿åº¦ 8-14 ä¸ªæ°¨åŸºé…¸

**å¤‡é€‰æ–¹æ¡ˆ**ï¼š

å¦‚æœ IEDB API ä¸ç¨³å®šï¼Œè„šæœ¬å†…ç½®äº†**æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆå™¨**ï¼ŒåŸºäº HLA-A\*02:01 çš„å·²çŸ¥ç»“åˆè§„å¾‹ç”Ÿæˆè®­ç»ƒæ•°æ®ï¼š
- 9mer è‚½æ®µä¼˜å…ˆ
- ä½ç½® 2 å’Œä½ç½® 9 åå¥½ç–æ°´æ°¨åŸºé…¸ï¼ˆL, M, V, Iï¼‰
- åŒ…å«ä¸€å®šéšæœºå™ªå£°æ¨¡æ‹ŸçœŸå®æ•°æ®åˆ†å¸ƒ

---

## ğŸ§  æ–¹æ³•è®º

### æ•°æ®å¤„ç†æµç¨‹

1. **æ•°æ®æ¸…æ´—**
   - ç­›é€‰ HLA-A\*02:01 ç­‰ä½åŸºå› æ•°æ®
   - å»é™¤ä½è´¨é‡æ ·æœ¬å’Œé‡å¤æ•°æ®

2. **åºåˆ—ç¼–ç **
   - **Index Encoding**ï¼šå°† 20 ç§æ°¨åŸºé…¸æ˜ å°„ä¸º 1-20 çš„ç´¢å¼•
   - **Padding**ï¼šç»Ÿä¸€åºåˆ—é•¿åº¦è‡³ 14 ä¸ªæ°¨åŸºé…¸ï¼ˆä½¿ç”¨ 'X' å¡«å……ï¼‰

3. **æ•°æ®é›†åˆ’åˆ†**
   - è®­ç»ƒé›†ï¼š70%
   - éªŒè¯é›†ï¼š10%
   - æµ‹è¯•é›†ï¼š20%
   - é‡‡ç”¨åˆ†å±‚é‡‡æ ·ä¿æŒæ­£è´Ÿæ ·æœ¬æ¯”ä¾‹ä¸€è‡´

### æ¨¡å‹æ¶æ„

```
Input (batch_size, 14)
    â†“
Embedding Layer (21 vocab, 64 dim)
    â†“
Conv1d Layer 1 (128 channels, kernel=5)
    â†“ BatchNorm + ReLU + Dropout
Conv1d Layer 2 (256 channels, kernel=3)
    â†“ BatchNorm + ReLU + Dropout
Global Max Pooling
    â†“
Fully Connected Layer (256 units)
    â†“ BatchNorm + ReLU + Dropout
Fully Connected Layer (128 units)
    â†“ BatchNorm + ReLU + Dropout
Output Layer (1 unit)
    â†“ Sigmoid
Prediction (batch_size, 1)
```

**ç”Ÿç‰©å­¦æ„ä¹‰**ï¼š

- **Embedding å±‚**ï¼šå­¦ä¹ æ°¨åŸºé…¸çš„è¯­ä¹‰è¡¨ç¤ºï¼Œç›¸ä¼¼çš„æ°¨åŸºé…¸ï¼ˆå¦‚ç–æ°´æ€§ L, I, Vï¼‰ä¼šè·å¾—ç›¸è¿‘çš„åµŒå…¥å‘é‡
- **Conv1d å±‚**ï¼šæ•æ‰åºåˆ—ä¸­çš„å±€éƒ¨ Motif æ¨¡å¼ï¼Œç‰¹åˆ«æ˜¯ HLA-A\*02:01 çš„é”šå®šä½ç‚¹ï¼ˆä½ç½® 2 å’Œä½ç½® 9ï¼‰
- **Global Max Pooling**ï¼šæå–æœ€æ˜¾è‘—çš„ç‰¹å¾ä¿¡å·ï¼Œå¢å¼ºæ¨¡å‹å¯¹å…³é”®ä½ç‚¹çš„æ•æ„Ÿæ€§
- **Dropout**ï¼šé˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæé«˜æ³›åŒ–èƒ½åŠ›

### è®­ç»ƒç­–ç•¥

- **æŸå¤±å‡½æ•°**ï¼šäºŒå…ƒäº¤å‰ç†µ (Binary Cross Entropy)
- **ä¼˜åŒ–å™¨**ï¼šAdam (learning_rate = 0.001)
- **æ­£åˆ™åŒ–**ï¼šL2 weight decay (1e-5) + Dropout (0.3)
- **å­¦ä¹ ç‡è°ƒåº¦**ï¼šReduceLROnPlateauï¼ˆéªŒè¯æŸå¤± 5 ä¸ª epoch æ— æ”¹å–„åˆ™é™ä½å­¦ä¹ ç‡ï¼‰
- **æ—©åœç­–ç•¥**ï¼šéªŒè¯æŸå¤± 10 ä¸ª epoch æ— æ”¹å–„åˆ™åœæ­¢è®­ç»ƒ

---

## ğŸ“ˆ å®éªŒç»“æœ

### æ¨¡å‹æ€§èƒ½

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| Accuracy | TBD |
| Precision | TBD |
| Recall | TBD |
| F1 Score | TBD |
| ROC AUC | TBD |

### å¯è§†åŒ–ç»“æœ

- **ROC æ›²çº¿**ï¼šå±•ç¤ºä¸åŒé˜ˆå€¼ä¸‹çš„ TPR-FPR æƒè¡¡
- **æ··æ·†çŸ©é˜µ**ï¼šå±•ç¤ºæ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„åˆ†ç±»è¡¨ç°
- **Precision-Recall æ›²çº¿**ï¼šè¯„ä¼°æ¨¡å‹åœ¨æ­£æ ·æœ¬é¢„æµ‹ä¸Šçš„æ€§èƒ½

> ğŸ“¸ ç»“æœå›¾ç¤ºå°†ä¿å­˜åœ¨ `results/model_performance.png`

---

## ğŸš€ ä½¿ç”¨æŒ‡å—

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- PyTorch 1.10+
- CUDAï¼ˆå¯é€‰ï¼Œç”¨äº GPU åŠ é€Ÿï¼‰

### å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### å¿«é€Ÿå¼€å§‹

#### 1. æ•°æ®ä¸‹è½½

```bash
python 01_data_download.py
```

è¾“å‡ºï¼š
- `data/iedb_mock_data.csv`ï¼ˆæˆ– `iedb_raw_data.csv`ï¼‰

#### 2. æ•°æ®å¤„ç†

```bash
python 02_data_processing.py
```

è¾“å‡ºï¼š
- `data/processed_data.pkl`

#### 3. æ¨¡å‹è®­ç»ƒ

```bash
python 03_model.py  # æµ‹è¯•æ¨¡å‹æ¶æ„
python 04_train.py  # å¼€å§‹è®­ç»ƒ
```

è¾“å‡ºï¼š
- `models/best_model.pth`ï¼ˆæœ€ä½³æ¨¡å‹æƒé‡ï¼‰
- `results/training_history.csv`ï¼ˆè®­ç»ƒå†å²ï¼‰

#### 4. æ¨¡å‹è¯„ä¼°

```bash
python 05_evaluate.py
```

è¾“å‡ºï¼š
- `results/roc_curve.png`ï¼ˆROC æ›²çº¿ï¼‰
- `results/confusion_matrix.png`ï¼ˆæ··æ·†çŸ©é˜µï¼‰
- `results/pr_curve.png`ï¼ˆPR æ›²çº¿ï¼‰
- `results/model_performance.png`ï¼ˆç»¼åˆå¯è§†åŒ–ï¼‰
- `results/evaluation_report.txt`ï¼ˆè¯„ä¼°æŠ¥å‘Šï¼‰

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
mhci_binding_predictor/
â”‚
â”œâ”€â”€ data/                          # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ iedb_mock_data.csv         # æ¨¡æ‹Ÿ/åŸå§‹æ•°æ®
â”‚   â””â”€â”€ processed_data.pkl         # å¤„ç†åçš„æ•°æ®
â”‚
â”œâ”€â”€ models/                        # æ¨¡å‹ç›®å½•
â”‚   â””â”€â”€ best_model.pth             # æœ€ä½³æ¨¡å‹æƒé‡
â”‚
â”œâ”€â”€ results/                       # ç»“æœç›®å½•
â”‚   â”œâ”€â”€ training_history.csv       # è®­ç»ƒå†å²
â”‚   â”œâ”€â”€ roc_curve.png              # ROC æ›²çº¿
â”‚   â”œâ”€â”€ confusion_matrix.png       # æ··æ·†çŸ©é˜µ
â”‚   â”œâ”€â”€ pr_curve.png               # PR æ›²çº¿
â”‚   â”œâ”€â”€ model_performance.png      # ç»¼åˆå¯è§†åŒ–
â”‚   â””â”€â”€ evaluation_report.txt      # è¯„ä¼°æŠ¥å‘Š
â”‚
â”œâ”€â”€ logs/                          # æ—¥å¿—ç›®å½•
â”‚
â”œâ”€â”€ 01_data_download.py            # æ•°æ®ä¸‹è½½è„šæœ¬
â”œâ”€â”€ 02_data_processing.py          # æ•°æ®å¤„ç†è„šæœ¬
â”œâ”€â”€ 03_model.py                    # æ¨¡å‹å®šä¹‰
â”œâ”€â”€ 04_train.py                    # è®­ç»ƒè„šæœ¬
â”œâ”€â”€ 05_evaluate.py                 # è¯„ä¼°è„šæœ¬
â”œâ”€â”€ requirements.txt               # ä¾èµ–åˆ—è¡¨
â””â”€â”€ README.md                      # é¡¹ç›®æ–‡æ¡£
```

---

## ğŸ”§ æŠ€æœ¯æ ˆ

- **æ•°æ®å¤„ç†**ï¼šPandas, NumPy, scikit-learn
- **æ·±åº¦å­¦ä¹ æ¡†æ¶**ï¼šPyTorch 2.0+
- **å¯è§†åŒ–**ï¼šMatplotlib, Seaborn
- **æ•°æ®è·å–**ï¼šrequests, IEDB API

---

## ğŸ’¡ æœªæ¥æ”¹è¿›æ–¹å‘

1. **æ•°æ®æ‰©å±•**
   - æ•´åˆæ›´å¤š HLA ç­‰ä½åŸºå› ï¼ˆå¦‚ HLA-B, HLA-Cï¼‰
   - å¼•å…¥å®šé‡äº²å’ŒåŠ›æ•°æ®ï¼ˆIC50 å€¼ï¼‰è¿›è¡Œå›å½’é¢„æµ‹

2. **æ¨¡å‹ä¼˜åŒ–**
   - å°è¯• Transformer æ¶æ„æ•æ‰é•¿è·ç¦»ä¾èµ–
   - å¼•å…¥æ³¨æ„åŠ›æœºåˆ¶å¯è§†åŒ–å…³é”®ç»“åˆä½ç‚¹
   - å¤šä»»åŠ¡å­¦ä¹ ï¼ˆåŒæ—¶é¢„æµ‹å¤šä¸ª HLA ç­‰ä½åŸºå› ï¼‰

3. **åº”ç”¨æ‹“å±•**
   - æ„å»ºè‚¿ç˜¤æ–°æŠ—åŸé¢„æµ‹æµç¨‹
   - ç»“åˆ RNA-seq æ•°æ®é¢„æµ‹ä¸ªæ€§åŒ–æ–°æŠ—åŸ
   - é›†æˆåˆ°è‚¿ç˜¤å…ç–«æ²»ç–—å†³ç­–æ”¯æŒç³»ç»Ÿ

---

## ğŸ“š å‚è€ƒæ–‡çŒ®

1. **IEDB Database**:
   - Vita R, et al. The immune epitope database (IEDB) 3.0. *Nucleic Acids Res*. 2015.

2. **MHC-I Binding Prediction**:
   - Nielsen M, Andreatta M. NetMHCpan-3.1: improved prediction of MHC class I antigen presentation. *Immunogenetics*. 2019.

3. **Deep Learning in Immunology**:
   - Bhattacharya J, et al. Deep learning methods for MHC class I binding prediction. *Bioinformatics*. 2021.

---

## ğŸ‘¨â€ğŸ’» ä½œè€…ä¿¡æ¯

**é¡¹ç›®æ‰§è¡Œè€…**: [Your Name]

**ç ”ç©¶æ–¹å‘**:
- è®¡ç®—ç”Ÿç‰©å­¦
- ç”Ÿç‰©ä¿¡æ¯å­¦
- äººå·¥æ™ºèƒ½åœ¨ç”Ÿå‘½ç§‘å­¦ä¸­çš„åº”ç”¨

**ç›®æ ‡å®éªŒå®¤**:
- æ¸…åå¤§å­¦åŒ»å­¦é™¢
- è“å‹‹æ•™æˆè¯¾é¢˜ç»„ï¼ˆè‚¿ç˜¤è¿›åŒ–ã€å…ç–«é€ƒé€¸ã€AIåŸºå› ç»„å­¦ï¼‰

---

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿è”ç³»ï¼š
- Email: [Your Email]
- GitHub: [Your GitHub Profile]

---

**æœ€åæ›´æ–°**: 2025-01-07
