2026-01-07 19:38:41,342 - INFO - 训练器初始化完成
2026-01-07 19:38:41,342 - INFO - 设备: cuda
2026-01-07 19:38:41,343 - INFO - 模型参数数量: 290,497
2026-01-07 19:38:41,343 - INFO - ============================================================
2026-01-07 19:38:41,343 - INFO - 开始训练
2026-01-07 19:38:41,343 - INFO - ============================================================
2026-01-07 19:38:41,974 - INFO - ✓ 保存最佳模型 (Epoch 1)
2026-01-07 19:38:41,974 - INFO - Epoch [1/50] 0.6s - Train Loss: 0.8555, Acc: 0.4791 | Val Loss: 0.6011, Acc: 0.8283, AUC: 0.5366 | LR: 0.001000
2026-01-07 19:38:42,005 - INFO - ✓ 保存最佳模型 (Epoch 2)
2026-01-07 19:38:42,005 - INFO - Epoch [2/50] 0.0s - Train Loss: 0.6968, Acc: 0.5945 | Val Loss: 0.4775, Acc: 0.8283, AUC: 0.5947 | LR: 0.001000
2026-01-07 19:38:42,034 - INFO - ✓ 保存最佳模型 (Epoch 3)
2026-01-07 19:38:42,034 - INFO - Epoch [3/50] 0.0s - Train Loss: 0.5786, Acc: 0.7229 | Val Loss: 0.4599, Acc: 0.8283, AUC: 0.5194 | LR: 0.001000
2026-01-07 19:38:42,055 - INFO - Epoch [4/50] 0.0s - Train Loss: 0.4613, Acc: 0.7807 | Val Loss: 0.4743, Acc: 0.8283, AUC: 0.5796 | LR: 0.001000
2026-01-07 19:38:42,076 - INFO - Epoch [5/50] 0.0s - Train Loss: 0.4447, Acc: 0.7937 | Val Loss: 0.4890, Acc: 0.8283, AUC: 0.6456 | LR: 0.001000
2026-01-07 19:38:42,105 - INFO - ✓ 保存最佳模型 (Epoch 6)
2026-01-07 19:38:42,105 - INFO - Epoch [6/50] 0.0s - Train Loss: 0.4048, Acc: 0.8326 | Val Loss: 0.4573, Acc: 0.8283, AUC: 0.6937 | LR: 0.001000
2026-01-07 19:38:42,126 - INFO - Epoch [7/50] 0.0s - Train Loss: 0.3469, Acc: 0.8499 | Val Loss: 0.4812, Acc: 0.8283, AUC: 0.7109 | LR: 0.001000
2026-01-07 19:38:42,146 - INFO - Epoch [8/50] 0.0s - Train Loss: 0.3047, Acc: 0.8701 | Val Loss: 0.5402, Acc: 0.8283, AUC: 0.7432 | LR: 0.001000
2026-01-07 19:38:42,166 - INFO - Epoch [9/50] 0.0s - Train Loss: 0.2917, Acc: 0.8918 | Val Loss: 0.5470, Acc: 0.8283, AUC: 0.7697 | LR: 0.001000
2026-01-07 19:38:42,188 - INFO - Epoch [10/50] 0.0s - Train Loss: 0.2358, Acc: 0.9076 | Val Loss: 0.4621, Acc: 0.8283, AUC: 0.8020 | LR: 0.001000
2026-01-07 19:38:42,218 - INFO - ✓ 保存最佳模型 (Epoch 11)
2026-01-07 19:38:42,218 - INFO - Epoch [11/50] 0.0s - Train Loss: 0.1974, Acc: 0.9221 | Val Loss: 0.3778, Acc: 0.8283, AUC: 0.8329 | LR: 0.001000
2026-01-07 19:38:42,246 - INFO - ✓ 保存最佳模型 (Epoch 12)
2026-01-07 19:38:42,246 - INFO - Epoch [12/50] 0.0s - Train Loss: 0.1787, Acc: 0.9394 | Val Loss: 0.3181, Acc: 0.8485, AUC: 0.8780 | LR: 0.001000
2026-01-07 19:38:42,267 - INFO - Epoch [13/50] 0.0s - Train Loss: 0.1414, Acc: 0.9538 | Val Loss: 0.3505, Acc: 0.7980, AUC: 0.8953 | LR: 0.001000
2026-01-07 19:38:42,288 - INFO - Epoch [14/50] 0.0s - Train Loss: 0.1277, Acc: 0.9639 | Val Loss: 0.3735, Acc: 0.7980, AUC: 0.8917 | LR: 0.001000
2026-01-07 19:38:42,308 - INFO - Epoch [15/50] 0.0s - Train Loss: 0.1338, Acc: 0.9495 | Val Loss: 0.3955, Acc: 0.8081, AUC: 0.8867 | LR: 0.001000
2026-01-07 19:38:42,330 - INFO - Epoch [16/50] 0.0s - Train Loss: 0.0930, Acc: 0.9711 | Val Loss: 0.4446, Acc: 0.7980, AUC: 0.8709 | LR: 0.001000
2026-01-07 19:38:42,353 - INFO - Epoch [17/50] 0.0s - Train Loss: 0.0689, Acc: 0.9827 | Val Loss: 0.5373, Acc: 0.7374, AUC: 0.8515 | LR: 0.001000
2026-01-07 19:38:42,376 - INFO - Epoch [18/50] 0.0s - Train Loss: 0.0647, Acc: 0.9827 | Val Loss: 0.3986, Acc: 0.8081, AUC: 0.8637 | LR: 0.000500
2026-01-07 19:38:42,400 - INFO - Epoch [19/50] 0.0s - Train Loss: 0.0523, Acc: 0.9899 | Val Loss: 0.3710, Acc: 0.8283, AUC: 0.8745 | LR: 0.000500
2026-01-07 19:38:42,430 - INFO - Epoch [20/50] 0.0s - Train Loss: 0.0562, Acc: 0.9885 | Val Loss: 0.3303, Acc: 0.8485, AUC: 0.8924 | LR: 0.000500
2026-01-07 19:38:42,454 - INFO - Epoch [21/50] 0.0s - Train Loss: 0.0726, Acc: 0.9870 | Val Loss: 0.3319, Acc: 0.8687, AUC: 0.9003 | LR: 0.000500
2026-01-07 19:38:42,475 - INFO - Epoch [22/50] 0.0s - Train Loss: 0.0610, Acc: 0.9812 | Val Loss: 0.3645, Acc: 0.8384, AUC: 0.9053 | LR: 0.000500
2026-01-07 19:38:42,475 - INFO - 
早停触发！连续 10 个 Epoch 无改善
2026-01-07 19:38:42,475 - INFO - 
============================================================
2026-01-07 19:38:42,475 - INFO - 训练完成
2026-01-07 19:38:42,475 - INFO - ============================================================
2026-01-07 19:38:42,475 - INFO - 总训练时间: 0.0 分钟
2026-01-07 19:38:42,475 - INFO - 最佳 Epoch: 12
2026-01-07 19:38:42,475 - INFO - 最佳验证损失: 0.3181
2026-01-07 19:38:42,475 - INFO - 最佳验证准确率: 0.8485
2026-01-07 19:38:42,475 - INFO - 最佳验证 AUC: 0.8780
2026-01-07 19:38:42,475 - INFO - 模型保存位置: models/best_model.pth
============================================================
MHC-I 模型训练程序
============================================================

正在检查计算环境...
✓ CUDA 可用
  GPU 设备: NVIDIA GeForce RTX 4060 Laptop GPU
  GPU 数量: 1
  当前 GPU: 0
  GPU 内存: 8.0 GB

使用设备: cuda

正在加载数据...
训练集: 693 样本
验证集: 99 样本

正在创建数据加载器...
训练批次: 6
验证批次: 1

正在创建模型...
模型参数数量: 290,497

训练历史已保存至: results/training_history.csv

训练完成！
